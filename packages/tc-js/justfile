fork_url := env_var("RPC_URL_MAINNET")
fork_block := "22300000"

wasm:
    wasm-pack build --target nodejs ../../crates/tc-rs --out-dir ../../packages/tc-js/src/pkg --no-default-features --features wasm,broadcaster

integration-transact:
    #!/usr/bin/env bash
    set -euo pipefail

    # Start anvil in background
    anvil --fork-url {{fork_url}} --fork-block-number {{fork_block}} --port 8545 &
    ANVIL_PID=$!
    trap "kill $ANVIL_PID 2>/dev/null" EXIT

    # Wait for anvil to be ready
    sleep 2

    pnpm vitest run -t "transact"

# integration-broadcast:
#     #!/usr/bin/env bash
#     set -euo pipefail

#     # Start anvil in background
#     anvil --fork-url {{fork_url}} --fork-block-number {{fork_block}} --port 8545 &
#     ANVIL_PID=$!
#     trap "kill $ANVIL_PID 2>/dev/null" EXIT

#     # Wait for anvil to be ready
#     sleep 2

#     pnpm vitest run -t "broadcast"
